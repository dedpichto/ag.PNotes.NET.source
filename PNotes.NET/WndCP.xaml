<Window x:Class="PNotes.NET.WndCP"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:net="clr-namespace:PNotes.NET"
        xmlns:sts="clr-namespace:WPFStandardStyles;assembly=WPFStandardStyles"
        Name="DlgCP"
        Title="Control Panel" 
        Height="600" 
        Width="1000"
        Icon="{DynamicResource note_pinned}"
        Style="{DynamicResource CustomWindowStyle}"
        TextElement.FontFamily="{Binding FontFamily}"
        TextElement.FontSize="{Binding FontSize}"
        TextElement.FontStretch="{Binding FontStretch}"
        TextElement.FontStyle="{Binding FontStyle}"
        TextElement.FontWeight="{Binding FontWeight}"
        Loaded="DlgCP_Loaded"
        Closed="DlgCP_Closed"
        SourceInitialized="DlgCP_SourceInitialized"
        SizeChanged="DlgCP_SizeChanged"
        Activated="DlgCP_Activated">
    <Window.CommandBindings>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupAddCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupAddSubgroupCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupEditCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupRemoveCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupShowCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupShowAllCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupHideCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupHideAllCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupPassAddCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupPassRemoveCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>

        <CommandBinding Command="{x:Static net:MainCommands.NewNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.LoadNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.NoteFromClipboardCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.DuplicateNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SaveAsShortcutCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.DiaryCommand}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.Today}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:NoteCommands.SaveNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SaveAsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SaveAsTextCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.RestoreFromBackupCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.PrintCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Adjust}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.AdjustAppearance}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.AdjustSchedule}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:NoteCommands.DeleteNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.SaveAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.BackupSyncCommand}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.BackupCreate}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.BackupRestore}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.SyncLocal}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ImportNotes}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ImportSettings}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ImportFonts}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ImportDictionaries}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpPdf}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpTiff}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpDoc}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpRtf}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpTxt}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ExpAll}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.PrintFields}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Placement}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.DockAll}" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.DockAllNone}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.DockAllLeft}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.DockAllTop}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.DockAllRight}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.DockAllBottom}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Visibility}" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ShowNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ShowAll}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.HideNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.HideAll}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.AllToFront}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Centralize}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:NoteCommands.SendAsTextCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SendAsAttachmentCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SendAsZipCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.SendNetworkCommand}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.ContactAdd}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ContactGroupAdd}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ContactSelect}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ContactGroupSelect}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:NoteCommands.TagsCommand}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.TagsCurrent}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.TagsShowBy}" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.TagsHideBy}" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Switches}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.OnTop}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.HighPriority}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ProtectionMode}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.SetNotePassword}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.RemoveNotePassword}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.MarkAsComplete}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.RollUnroll}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Pin}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Unpin}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Scramble}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.Unscramble}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:NoteCommands.AddFavoritesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:NoteCommands.RemoveFavoritesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.RunCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.EmptyBin}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.RestoreNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Preview}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewSettings}" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.UseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ChooseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewRight}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewRightFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowGroupsOnCp}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowGroupsOnCpFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.ColReset}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.HotkeysCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.MenusManagementCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.PreferencesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Password}" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.Search}" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:ControlPanelCommands.QuickSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.HelpCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.SupportCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:MainCommands.AboutCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <!--<CommandBinding Command="{x:Static net:PNCommands.PwrdCreate}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.PwrdChange}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.PwrdRemove}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->
        <!--<CommandBinding Command="{x:Static net:PNCommands.SearchInNotes}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.SearchByTags}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.SearchByDates}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.IncBinInQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.ClearQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="{x:Static net:PNCommands.QSearchIgnoreCase}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>-->

    </Window.CommandBindings>
    <Window.Resources>
        <sys:String x:Key="Priority">Priority</sys:String>
        <sys:String x:Key="Completed">Completed</sys:String>
        <sys:String x:Key="Protected">Protected</sys:String>
        <sys:String x:Key="Pinned">Pinned</sys:String>
        <sys:String x:Key="Favorites">Favorites</sys:String>
        <sys:String x:Key="Encrypted">Encrypted</sys:String>


        <MenuItem x:Key="mnuOnTop" Name="mnuOnTop" x:Shared="false" IsCheckable="True" Command="net:NoteCommands.OnTopCommand"/>
        <MenuItem x:Key="mnuToggleHighPriority" Name="mnuToggleHighPriority" x:Shared="false" IsCheckable="True" Command="net:NoteCommands.HighPriorityCommand"/>
        <MenuItem x:Key="mnuToggleProtectionMode" Name="mnuToggleProtectionMode" x:Shared="false" IsCheckable="True" Command="net:NoteCommands.ProtectionModeCommand"/>
        <MenuItem x:Key="mnuSetPassword" Name="mnuSetPassword" x:Shared="false" Command="net:NoteCommands.SetNotePasswordCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource passadd}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuRemovePassword" Name="mnuRemovePassword" x:Shared="false" Command="net:NoteCommands.RemoveNotePasswordCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource passremove}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuMarkAsComplete" Name="mnuMarkAsComplete" x:Shared="false" IsCheckable="True" Command="net:NoteCommands.MarkAsCompleteCommand"/>
        <MenuItem x:Key="mnuRollUnroll" Name="mnuRollUnroll" x:Shared="false" Command="net:NoteCommands.RollUnrollCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource rollunroll}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuPin" Name="mnuPin" x:Shared="false" Command="net:NoteCommands.PinCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource pinadd}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuUnpin" Name="mnuUnpin" x:Shared="false" Command="net:NoteCommands.UnpinCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource pinremove}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuScramble" Name="mnuScramble" x:Shared="false" Command="net:NoteCommands.ScrambleCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource scramble}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuUnscramble" Name="mnuUnscramble" x:Shared="false" Command="net:NoteCommands.UnscrambleCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource unscramble}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem Name="mnuUseCustColor" x:Key="mnuUseCustColor" x:Shared="false" IsCheckable="True" Command="net:ControlPanelCommands.UseCustColor"/>
        <MenuItem Name="mnuChooseCustColor" x:Key="mnuChooseCustColor" x:Shared="false" Command="net:ControlPanelCommands.ChooseCustColor">
            <MenuItem.Icon>
                <Image Source="{DynamicResource colorpicker}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuPwrdCreate" Name="mnuPwrdCreate" x:Shared="false" Command="net:CommonCommands.PwrdCreateCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource passadd}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuPwrdChange" Name="mnuPwrdChange" x:Shared="false" Command="net:CommonCommands.PwrdChangeCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource passedit}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuPwrdRemove" Name="mnuPwrdRemove" x:Shared="false" Command="net:CommonCommands.PwrdRemoveCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource passremove}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuSearchInNotes" Name="mnuSearchInNotes" x:Shared="false" Command="net:MainCommands.SearchInNotesCommand"/>
        <MenuItem x:Key="mnuSearchByTags" Name="mnuSearchByTags" x:Shared="false" Command="net:MainCommands.SearchByTagsCommand"/>
        <MenuItem x:Key="mnuSearchByDates" Name="mnuSearchByDates" x:Shared="false" Command="net:MainCommands.SearchByDatesCommand"/>
        <MenuItem x:Key="mnuIncBinInQSearch" Name="mnuIncBinInQSearch" x:Shared="false" Command="net:ControlPanelCommands.IncBinInQSearch"/>
        <MenuItem x:Key="mnuClearQSearch" Name="mnuClearQSearch" x:Shared="false" Command="net:ControlPanelCommands.ClearQSearch"/>
        <MenuItem x:Key="mnuQSearchIgnoreCase" Name="mnuQSearchIgnoreCase" x:Shared="false" Command="net:ControlPanelCommands.QSearchIgnoreCase"/>
        <MenuItem x:Key="mnuTodayDiary" Name="mnuTodayDiary" x:Shared="false" Command="net:MainCommands.TodayCommand"/>
        <MenuItem x:Key="mnuAdjustAppearance" Name="mnuAdjustAppearance" x:Shared="false" Command="net:NoteCommands.AdjustAppearanceCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource adjustapp}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuAdjustSchedule" Name="mnuAdjustSchedule" x:Shared="false" Command="net:NoteCommands.AdjustScheduleCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource adjustsch}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuBackupCreate" Name="mnuBackupCreate" x:Shared="false" Command="net:MainCommands.BackupCreateCommand"/>
        <MenuItem x:Key="mnuBackupRestore" Name="mnuBackupRestore" x:Shared="false" Command="net:MainCommands.BackupRestoreCommand"/>
        <MenuItem x:Key="mnuSyncLocal" Name="mnuSyncLocal" x:Shared="false" Command="net:MainCommands.SyncLocalCommand"/>
        <MenuItem x:Key="mnuImportNotes" Name="mnuImportNotes" x:Shared="false" Command="net:MainCommands.ImportNotesCommand"/>
        <MenuItem x:Key="mnuImportSettings" Name="mnuImportSettings" x:Shared="false" Command="net:MainCommands.ImportSettingsCommand"/>
        <MenuItem x:Key="mnuImportFonts" Name="mnuImportFonts" x:Shared="false" Command="net:MainCommands.ImportFontsCommand"/>
        <MenuItem x:Key="mnuImportDictionaries" Name="mnuImportDictionaries" x:Shared="false" Command="net:MainCommands.ImportDictionariesCommand"/>
        <MenuItem x:Key="mnuExportAll" Name="mnuExportAll" x:Shared="false" Command="net:MainCommands.ExpAllCommand">
            <MenuItem Name="mnuExpPdf" Command="net:MainCommands.ExpPdfCommand"/>
            <MenuItem Name="mnuExpTif" Command="net:MainCommands.ExpTiffCommand"/>
            <MenuItem Name="mnuExpDoc" Command="net:MainCommands.ExpDocCommand"/>
            <MenuItem Name="mnuExpRtf" Command="net:MainCommands.ExpRtfCommand"/>
            <MenuItem Name="mnuExpTxt" Command="net:MainCommands.ExpTxtCommand"/>
            <Separator Name="sepConfRep"/>
            <MenuItem Name="mnuPrintFields" Command="net:MainCommands.PrintFieldsCommand"/>
        </MenuItem>
        <MenuItem x:Key="mnuDockAll" Name="mnuDockAll" x:Shared="false" Command="net:MainCommands.DockAllCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource dockall}"/>
            </MenuItem.Icon>
            <MenuItem Name="mnuDAllNone" Command="net:CommonCommands.DockNoneCommand"/>
            <MenuItem Name="mnuDAllLeft" Command="net:CommonCommands.DockLeftCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource dockleft}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuDAllTop" Command="net:CommonCommands.DockTopCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource docktop}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuDAllRight" Command="net:CommonCommands.DockRightCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource dockright}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuDAllBottom" Command="net:CommonCommands.DockBottomCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource dockbottom}"/>
                </MenuItem.Icon>
            </MenuItem>
        </MenuItem>
        <MenuItem x:Key="mnuVisibility" Name="mnuVisibility" x:Shared="false" Command="net:ControlPanelCommands.Visibility">
            <MenuItem.Icon>
                <Image Source="{DynamicResource placevis}"/>
            </MenuItem.Icon>
            <MenuItem Name="mnuShowNote" Command="net:ControlPanelCommands.ShowNote">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource shownote}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuShowAll" Command="net:MainCommands.ShowAllCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource showgroups}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuHideNote" Command="net:NoteCommands.HideNoteCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource hidenote}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuHideAll" Command="net:MainCommands.HideAllCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource hidegroups}"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Name="mnuAllToFront" Command="net:MainCommands.AllToFrontCommand">
                <MenuItem.Icon>
                    <Image Source="{DynamicResource front}"/>
                </MenuItem.Icon>
            </MenuItem>
        </MenuItem>
        <MenuItem x:Key="mnuCentralize" Name="mnuCentralize" x:Shared="false" Command="net:ControlPanelCommands.Centralize">
            <MenuItem.Icon>
                <Image Source="{DynamicResource centralize}"/>
            </MenuItem.Icon>
        </MenuItem>

        <MenuItem x:Key="mnuAddContact" Name="mnuAddContact" x:Shared="false" Command="net:NoteCommands.ContactAddCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource contactadd}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuAddGroup" Name="mnuAddGroup" x:Shared="false" Command="net:NoteCommands.ContactGroupAddCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource groupadd}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuSelectContact" Name="mnuSelectContact" x:Shared="false" Command="net:NoteCommands.ContactSelectCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource contactselect}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuSelectGroup" Name="mnuSelectGroup" x:Shared="false" Command="net:NoteCommands.ContactGroupSelectCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource groupselect}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuTagsCurrent" Name="mnuTagsCurrent" x:Shared="false" Command="net:ControlPanelCommands.TagsCurrent">
            <MenuItem.Icon>
                <Image Source="{DynamicResource tags}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuShowByTag" Name="mnuShowByTag" x:Shared="false" Command="net:MainCommands.TagsShowByCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource showtag}"/>
            </MenuItem.Icon>
        </MenuItem>
        <MenuItem x:Key="mnuHideByTag" Name="mnuHideByTag" x:Shared="false" Command="net:MainCommands.TagsHideByCommand">
            <MenuItem.Icon>
                <Image Source="{DynamicResource hidetag}"/>
            </MenuItem.Icon>
        </MenuItem>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>
        <DockPanel Grid.Row="0">
            <WrapPanel Name="tbrCp" DockPanel.Dock="Top" Margin="4,0,4,0" Background="{DynamicResource ToolbarBackgrounsBrush}">
                <sts:ToolbarButton x:Name="cmdNewNote" Command="net:MainCommands.NewNoteCommand">
                    <Image Stretch="None" Source="{DynamicResource new_note}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdLoadNotes" Command="net:MainCommands.LoadNoteCommand">
                    <Image Stretch="None" Source="{DynamicResource load}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdNoteFromCB" Command="net:MainCommands.NoteFromClipboardCommand">
                    <Image Stretch="None" Source="{DynamicResource fromcp}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdDuplicateNote" Command="net:NoteCommands.DuplicateNoteCommand">
                    <Image Stretch="None" Source="{DynamicResource note_copy}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdSaveAsShortcut" Command="net:NoteCommands.SaveAsShortcutCommand">
                    <Image Stretch="None" Source="{DynamicResource shortcut}"/>
                </sts:ToolbarButton>
                <sts:DropDownButton x:Name="cmdDiary" Command="net:MainCommands.DiaryCommand" DropDownOpened="Diary_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource diary}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:MainCommands.TodayCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuTodayDiary"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdSave" Command="net:NoteCommands.SaveNoteCommand">
                    <Image Stretch="None" Source="{DynamicResource save}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdSaveAs" Command="net:NoteCommands.SaveAsCommand">
                    <Image Stretch="None" Source="{DynamicResource saveas}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdSaveAsText" Command="net:NoteCommands.SaveAsTextCommand">
                    <Image Stretch="None" Source="{DynamicResource saveastext}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdRestoreFromBackup" Command="net:NoteCommands.RestoreFromBackupCommand">
                    <Image Stretch="None" Source="{DynamicResource restore}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdPrint" Command="net:NoteCommands.PrintCommand">
                    <Image Stretch="None" Source="{DynamicResource print}"/>
                </sts:ToolbarButton>
                <sts:DropDownButton x:Name="cmdAdjust" Command="net:ControlPanelCommands.Adjust">
                    <Image Stretch="None" Source="{DynamicResource control}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:NoteCommands.AdjustAppearanceCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.AdjustScheduleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuAdjustAppearance"/>
                            <StaticResourceExtension ResourceKey="mnuAdjustSchedule"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdDelete" Command="net:NoteCommands.DeleteNoteCommand">
                    <Image Stretch="None" Source="{DynamicResource deletenote}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdSaveAll" Command="net:MainCommands.SaveAllCommand">
                    <Image Stretch="None" Source="{DynamicResource saveall}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdBackup" Command="net:MainCommands.BackupSyncCommand">
                    <Image Stretch="None" Source="{DynamicResource back}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:MainCommands.BackupCreateCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.BackupRestoreCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.SyncLocalCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ImportNotesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ImportSettingsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ImportFontsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ImportDictionariesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpPdfCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpTiffCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpDocCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpRtfCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpTxtCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ExpAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.PrintFieldsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuBackupCreate"/>
                            <StaticResourceExtension ResourceKey="mnuBackupRestore"/>
                            <StaticResourceExtension ResourceKey="mnuSyncLocal"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuImportNotes"/>
                            <StaticResourceExtension ResourceKey="mnuImportSettings"/>
                            <StaticResourceExtension ResourceKey="mnuImportFonts"/>
                            <StaticResourceExtension ResourceKey="mnuImportDictionaries"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuExportAll"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdPlacement" Command="net:ControlPanelCommands.Placement">
                    <Image Stretch="None" Source="{DynamicResource placevis}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:MainCommands.DockAllCommand}" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.DockNoneCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.DockLeftCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.DockTopCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.DockRightCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.DockBottomCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.Visibility}" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.ShowAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.HideNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.HideAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.AllToFrontCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.Centralize}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuDockAll"/>
                            <StaticResourceExtension ResourceKey="mnuVisibility"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuCentralize"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <sts:ToolbarButton x:Name="cmdSendAsText" Command="net:NoteCommands.SendAsTextCommand">
                    <Image Stretch="None" Source="{DynamicResource sendmail}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdSendAsAttachment" Command="net:NoteCommands.SendAsAttachmentCommand">
                    <Image Stretch="None" Source="{DynamicResource sendattach}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdSendZip" Command="net:NoteCommands.SendAsZipCommand">
                    <Image Stretch="None" Source="{DynamicResource mailzip}"/>
                </sts:ToolbarButton>
                <sts:DropDownButton x:Name="cmdSendNetwork" Command="net:NoteCommands.SendNetworkCommand">
                    <Image Stretch="None" Source="{DynamicResource sendnetwork}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu Opened="SendContextMenu_Opened">
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:NoteCommands.ContactAddCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.ContactGroupAddCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.ContactSelectCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.ContactGroupSelectCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuAddContact"/>
                            <StaticResourceExtension ResourceKey="mnuAddGroup"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuSelectContact"/>
                            <StaticResourceExtension ResourceKey="mnuSelectGroup"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdTags" Command="net:NoteCommands.TagsCommand" DropDownOpened="Tags_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource tags}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.TagsCurrent}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.TagsShowByCommand}" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.TagsHideByCommand}" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuTagsCurrent"/>
                            <StaticResourceExtension ResourceKey="mnuShowByTag"/>
                            <StaticResourceExtension ResourceKey="mnuHideByTag"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdSwitches" Command="net:ControlPanelCommands.Switches" DropDownOpened="Switches_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource check}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:NoteCommands.OnTopCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.HighPriorityCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.ProtectionModeCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.SetNotePasswordCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.RemoveNotePasswordCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.MarkAsCompleteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.RollUnrollCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.PinCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.UnpinCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.ScrambleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:NoteCommands.UnscrambleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuOnTop"/>
                            <StaticResourceExtension ResourceKey="mnuToggleHighPriority"/>
                            <StaticResourceExtension ResourceKey="mnuToggleProtectionMode"/>
                            <StaticResourceExtension ResourceKey="mnuSetPassword"/>
                            <StaticResourceExtension ResourceKey="mnuRemovePassword"/>
                            <StaticResourceExtension ResourceKey="mnuMarkAsComplete"/>
                            <StaticResourceExtension ResourceKey="mnuRollUnroll"/>
                            <StaticResourceExtension ResourceKey="mnuPin"/>
                            <StaticResourceExtension ResourceKey="mnuUnpin"/>
                            <StaticResourceExtension ResourceKey="mnuScramble"/>
                            <StaticResourceExtension ResourceKey="mnuUnscramble"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <sts:ToolbarButton x:Name="cmdFavorites" Command="net:NoteCommands.AddFavoritesCommand">
                    <Image Stretch="None" Source="{DynamicResource favadd}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdRemoveFromFavorites" Command="net:NoteCommands.RemoveFavoritesCommand">
                    <Image Stretch="None" Source="{DynamicResource favremove}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdRun" Command="net:MainCommands.RunCommand" DropDownOpened="Run_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource run}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <MenuItem/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdEmptyBin" Command="net:ControlPanelCommands.EmptyBin">
                    <Image Stretch="None" Source="{DynamicResource bin_empty}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdRestoreNote" Command="net:ControlPanelCommands.RestoreNote">
                    <Image Stretch="None" Source="{DynamicResource bin_restore}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarToggleButton x:Name="cmdPreview" IsChecked="True" Command="net:ControlPanelCommands.Preview">
                    <Image Stretch="None" Source="{DynamicResource preview}"/>
                </sts:ToolbarToggleButton>
                <sts:DropDownButton x:Name="cmdPreviewSettings" Command="net:ControlPanelCommands.PreviewSettings" DropDownOpened="PreviewSettings_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource preview_sett}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.UseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.ChooseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuUseCustColor"/>
                            <StaticResourceExtension ResourceKey="mnuChooseCustColor"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <sts:ToolbarToggleButton x:Name="cmdPreviewRight" Command="net:ControlPanelCommands.PreviewRight">
                    <Image Stretch="None" Source="{DynamicResource previewright}"/>
                </sts:ToolbarToggleButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarToggleButton x:Name="cmdShowGroups" IsChecked="True" Command="net:ControlPanelCommands.ShowGroupsOnCp">
                    <Image Stretch="None" Source="{DynamicResource gr_view}"/>
                </sts:ToolbarToggleButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdColReset" Command="net:ControlPanelCommands.ColReset">
                    <Image Stretch="None" Source="{DynamicResource coleven}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdHotkeysCP" Command="net:MainCommands.HotkeysCommand">
                    <Image Stretch="None" Source="{DynamicResource hotkeys}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdMenusManagementCP" Command="net:MainCommands.MenusManagementCommand">
                    <Image Stretch="None" Source="{DynamicResource menus}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdPreferences" Command="net:MainCommands.PreferencesCommand">
                    <Image Stretch="None" Source="{DynamicResource prefs}"/>
                </sts:ToolbarButton>
                <sts:DropDownButton x:Name="cmdPassword" Command="net:ControlPanelCommands.Password">
                    <Image Stretch="None" Source="{DynamicResource password}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:CommonCommands.PwrdCreateCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.PwrdChangeCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:CommonCommands.PwrdRemoveCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuPwrdCreate"/>
                            <StaticResourceExtension ResourceKey="mnuPwrdChange"/>
                            <StaticResourceExtension ResourceKey="mnuPwrdRemove"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:DropDownButton x:Name="cmdSearch" Command="net:ControlPanelCommands.Search" DropDownOpened="Search_DropDownOpened">
                    <Image Stretch="None" Source="{DynamicResource search}"/>
                    <sts:DropDownButton.DropDownMenu>
                        <ContextMenu>
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:MainCommands.SearchInNotesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.SearchByTagsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:MainCommands.SearchByDatesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.IncBinInQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.ClearQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlPanelCommands.QSearchIgnoreCase}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <StaticResourceExtension ResourceKey="mnuSearchInNotes"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuSearchByTags"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuSearchByDates"/>
                            <Separator/>
                            <StaticResourceExtension ResourceKey="mnuIncBinInQSearch"/>
                            <StaticResourceExtension ResourceKey="mnuClearQSearch"/>
                            <StaticResourceExtension ResourceKey="mnuQSearchIgnoreCase"/>
                        </ContextMenu>
                    </sts:DropDownButton.DropDownMenu>
                </sts:DropDownButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <Grid>
                    <TextBox Name="txtQSearch" VerticalAlignment="Center" LostFocus="txtQSearch_LostFocus"  GotFocus="txtQSearch_GotFocus"  TextChanged="txtQSearch_TextChanged" PreviewKeyDown="txtQSearch_PreviewKeyDown"/>
                    <TextBox Name="txtSearch" Text="Quick search" VerticalAlignment="Center" FontStyle="Italic" Opacity="0.3" IsVisibleChanged="txtSearch_IsVisibleChanged" GotFocus="txtSearch_GotFocus" MouseLeftButtonDown="txtSearch_MouseLeftButtonDown"/>
                </Grid>
                <sts:ToolbarButton x:Name="cmdQuickSearch" Command="net:ControlPanelCommands.QuickSearch">
                    <Image Stretch="None" Source="{DynamicResource searchweb}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdHelp" Command="net:MainCommands.HelpCommand">
                    <Image Stretch="None" Source="{DynamicResource help}"/>
                </sts:ToolbarButton>
                <Separator Style="{DynamicResource ToolbarSeparator}"/>
                <sts:ToolbarButton x:Name="cmdSupport" Command="net:MainCommands.SupportCommand">
                    <Image Stretch="None" Source="{DynamicResource support}"/>
                </sts:ToolbarButton>
                <sts:ToolbarButton x:Name="cmdAbout" Command="net:MainCommands.AboutCommand">
                    <Image Stretch="None" Source="{DynamicResource about}"/>
                </sts:ToolbarButton>
            </WrapPanel>
            <Border DockPanel.Dock="Top" Margin="4,0,4,0" Height="1" BorderThickness="1" BorderBrush="{DynamicResource CommonControlBorderBrush}"/>
            <Grid x:Name="OuterGrid"  Margin="4">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.45*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <WrapPanel Name="tbrGroups" Grid.Row="0" Grid.Column="0" Background="{DynamicResource ToolbarBackgrounsBrush}">
                    <sts:ToolbarButton x:Name="cmdAddTopGroup" Command="net:ControlGroupsCommands.GroupAddCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_add}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdAddSubgroup" Command="net:ControlGroupsCommands.GroupAddSubgroupCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_sub_add}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdEditGroup" Command="net:ControlGroupsCommands.GroupEditCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_edit}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdRemoveGroup" Command="net:ControlGroupsCommands.GroupRemoveCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_remove}"/>
                    </sts:ToolbarButton>
                    <Separator Style="{DynamicResource ToolbarSeparator}"/>
                    <sts:ToolbarButton x:Name="cmdShowAllFromGroup" Command="net:ControlGroupsCommands.GroupShowCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_show}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdShowAllIncSubgroups" Command="net:ControlGroupsCommands.GroupShowAllCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_show_all}"/>
                    </sts:ToolbarButton>
                    <Separator Style="{DynamicResource ToolbarSeparator}"/>
                    <sts:ToolbarButton x:Name="cmdHideAllFromGroup" Command="net:ControlGroupsCommands.GroupHideCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_hide}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdHideAllIncSubgroups" Command="net:ControlGroupsCommands.GroupHideAllCommand">
                        <Image Stretch="None" Source="{DynamicResource gr_hide_all}"/>
                    </sts:ToolbarButton>
                    <Separator Style="{DynamicResource ToolbarSeparator}"/>
                    <sts:ToolbarButton x:Name="cmdSetGroupPassword" Command="net:ControlGroupsCommands.GroupPassAddCommand">
                        <Image Stretch="None" Source="{DynamicResource passadd}"/>
                    </sts:ToolbarButton>
                    <sts:ToolbarButton x:Name="cmdRemoveGroupPassword" Command="net:ControlGroupsCommands.GroupPassRemoveCommand">
                        <Image Stretch="None" Source="{DynamicResource passremove}"/>
                    </sts:ToolbarButton>
                </WrapPanel>
                <Border Grid.Row="1" Grid.Column="0">
                    <Border.ContextMenu>
                        <ContextMenu x:Name="ctmGroups" 
                                 TextElement.FontFamily="{Binding FontFamily}"
                                 TextElement.FontSize="{Binding FontSize}"
                                 TextElement.FontStretch="{Binding FontStretch}"
                                 TextElement.FontStyle="{Binding FontStyle}"
                                 TextElement.FontWeight="{Binding FontWeight}"
                                 Closed="ctmGroups_Closed">
                            <ContextMenu.CommandBindings>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupAddCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupAddSubgroupCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupEditCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupRemoveCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupShowCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupShowAllCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupHideCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupHideAllCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupPassAddCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                                <CommandBinding Command="{x:Static net:ControlGroupsCommands.GroupPassRemoveCommand}" Executed="GroupCommand_Executed"  CanExecute="GroupCommand_CanExecute"/>
                            </ContextMenu.CommandBindings>
                            <Separator x:Name="sepGroupsMenu" Style="{DynamicResource TextSeparatorStyle}" sts:Utils.GroupData="Some group data"/>
                            <MenuItem Command="net:ControlGroupsCommands.GroupAddCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_add}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupAddSubgroupCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_sub_add}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupEditCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_edit}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupRemoveCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_remove}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Command="net:ControlGroupsCommands.GroupShowCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_show}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupShowAllCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_show_all}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Command="net:ControlGroupsCommands.GroupHideCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_hide}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupHideAllCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource gr_hide_all}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Command="net:ControlGroupsCommands.GroupPassAddCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource passadd}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Command="net:ControlGroupsCommands.GroupPassRemoveCommand">
                                <MenuItem.Icon>
                                    <Image Source="{DynamicResource passremove}"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </ContextMenu>
                    </Border.ContextMenu>
                </Border>
                <net:PNTreeView x:Name="tvwGroups" Grid.Row="1" Grid.Column="0" AllowDrop="True" SelectedItemChanged="tvwGroups_SelectedItemChanged" MouseRightButtonUp="tvwGroups_MouseRightButtonUp" PreviewMouseLeftButtonDown="tvwGroups_PreviewMouseLeftButtonDown" PreviewMouseMove="tvwGroups_PreviewMouseMove" DragEnter="tvwGroups_DragEnter" DragLeave="tvwGroups_DragLeave" DragOver="tvwGroups_DragOver" Drop="tvwGroups_Drop" PreviewMouseLeftButtonUp="tvwGroups_PreviewMouseLeftButtonUp" PreviewKeyDown="tvwGroups_PreviewKeyDown"/>
                <GridSplitter x:Name="SplitLeft" Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" HorizontalAlignment="Center" VerticalAlignment="Stretch" Width="8" Background="{DynamicResource SplitterBackgrounsBrush}"/>
                <Grid x:Name="InnerGrid" Grid.Row="0" Grid.Column="2" Grid.RowSpan="2">
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <ListView Name="grdBackup" sts:WPFGridViewHelper.AutoSort="True" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" Visibility="Hidden" SelectionChanged="grdBackup_SelectionChanged" MouseDoubleClick="grdBackup_MouseDoubleClick">
                        <ListView.Resources>
                            <ContextMenu x:Key="ListBackHeaderContextMenu">
                                <MenuItem Tag="Back_Name" Header="Note Name" IsChecked="True" IsEnabled="False"/>
                                <MenuItem Tag="Back_Original" Header="Original Note" IsCheckable="True" Checked="BackHeadeMenuItem_Checked" Unchecked="BackHeadeMenuItem_Checked"/>
                                <MenuItem Tag="Back_Saved" Header="Time Saved" IsCheckable="True" Checked="BackHeadeMenuItem_Checked" Unchecked="BackHeadeMenuItem_Checked"/>
                            </ContextMenu>
                            <Style TargetType="{x:Type GridViewColumnHeader}" BasedOn="{StaticResource {x:Type GridViewColumnHeader}}">
                                <Setter Property="ContextMenu" Value="{StaticResource ListBackHeaderContextMenu}"/>
                            </Style>
                        </ListView.Resources>
                        <ListView.View>
                            <GridView>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Back_Name" sts:WPFGridViewHelper.PropertyName="Name" Header="Note Name" FixedWidth="160" DefaultWidth="160" AllowResize="True" WidthChanged="BackColumn_WidthChanged">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Stretch="None" Source="{DynamicResource lsback}" Margin="2,0,2,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Back_Original" Header="Original Note" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding Original}" AllowResize="True" VisibilityChanged="BackColumnVisibilityChanged" WidthChanged="BackColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Back_Saved" Header="Time Created" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding Created, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="BackColumnVisibilityChanged" WidthChanged="BackColumn_WidthChanged"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <ListView Name="grdNotes" sts:WPFGridViewHelper.AutoSort="True" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" SelectionChanged="grdNotes_SelectionChanged" MouseDoubleClick="grdNotes_MouseDoubleClick" PreviewMouseLeftButtonDown="grdNotes_PreviewMouseLeftButtonDown" PreviewMouseMove="grdNotes_PreviewMouseMove" PreviewMouseLeftButtonUp="grdNotes_PreviewMouseLeftButtonUp" LostMouseCapture="grdNotes_LostMouseCapture" PreviewKeyDown="grdNotes_PreviewKeyDown">
                        <ListView.Resources>
                            <ContextMenu x:Key="ListNotesHeaderContextMenu">
                                <MenuItem Tag="Note_Name" Header="Note Name" IsChecked="True" IsEnabled="False"/>
                                <MenuItem Tag="Note_Id" Header="ID" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Priority" Header="Priority" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Completed" Header="Completed" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Locked" Header="Locked" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Password_Protected" Header="Password Protected" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Pinned" Header="Pinned" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Favorites" Header="Favorites" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Sent_Received" Header="Sent/Received" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Encrypted" Header="Encrypted" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Group" Header="Group" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_PrevGroup" Header="Group" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Created" Header="Created" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Saved" Header="Last Saved" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Deleted" Header="Deleted" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Schedule_Type" Header="Schedule Type" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Tags" Header="Tags" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Content" Header="Content" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Sent_To" Header="Sent To" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Sent_At" Header="Sent At" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Received_From" Header="Received From" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                                <MenuItem Tag="Note_Received_At" Header="Received At" IsCheckable="True" Checked="NotesHeaderMenuItem_Checked" Unchecked="NotesHeaderMenuItem_Checked"/>
                            </ContextMenu>
                            <Style TargetType="{x:Type GridViewColumnHeader}" BasedOn="{StaticResource {x:Type GridViewColumnHeader}}">
                                <Setter Property="ContextMenu" Value="{StaticResource ListNotesHeaderContextMenu}"/>
                            </Style>
                        </ListView.Resources>
                        <ListView.View>
                            <GridView>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Name" sts:WPFGridViewHelper.PropertyName="Name" Header="Note Name" FixedWidth="160" DefaultWidth="160" AllowResize="True" WidthChanged="NotesColumn_WidthChanged">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Stretch="None" net:PNUtils.ImageSourceKey="{Binding Path=State, Converter={StaticResource StateToImageConverter}}" Margin="2,0,2,0" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Id" Header="ID" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding Id}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Priority" sts:WPFGridViewHelper.PropertyName="Priority" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lspriority}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Priority, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Priority}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Completed" sts:WPFGridViewHelper.PropertyName="Completed" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lscomplete}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Completed, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Completed}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Locked" sts:WPFGridViewHelper.PropertyName="Protected" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lsprotect}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Protected, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Protected}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Password_Protected" sts:WPFGridViewHelper.PropertyName="PasswordCommand" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lspass}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Password, Converter={StaticResource PropToImageConverter}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Pinned" sts:WPFGridViewHelper.PropertyName="Pinned" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lspin}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Pinned, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Pinned}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Favorites" sts:WPFGridViewHelper.PropertyName="Favorites" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lsfav}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Favorites, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Favorites}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Sent_Received" sts:WPFGridViewHelper.PropertyName="SentReceived" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lssendrec}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding SentReceived, Converter={StaticResource PropToImageConverter}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ShowSortArrow="False" sts:WPFGridViewHelper.ColumnName="Note_Encrypted" sts:WPFGridViewHelper.PropertyName="Encrypted" FixedWidth="32" DefaultWidth="32" VisibilityChanged="NotesColumnVisibilityChanged">
                                    <sts:FixedWidthColumn.Header>
                                        <Image Source="{DynamicResource lsscrambled}" Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </sts:FixedWidthColumn.Header>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Stretch="None" HorizontalAlignment="Center" VerticalAlignment="Center" net:PNUtils.ImageSourceKey="{Binding Path=Encrypted, Converter={StaticResource PropToImageConverter}, ConverterParameter={StaticResource Encrypted}}"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </sts:FixedWidthColumn>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Group" Header="Group" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding Group}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_PrevGroup" Header="Group" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding PrevGroup}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Created" Header="Created" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding Created, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Saved" Header="Last Saved" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding Saved, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Deleted" Header="Deleted" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding Deleted, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Schedule_Type" Header="Schedule Type" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding ScheduleType}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Tags" Header="Tags" FixedWidth="120" DefaultWidth="120" DisplayMemberBinding="{Binding Tags}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Content" Header="Content" FixedWidth="160" DefaultWidth="160" DisplayMemberBinding="{Binding Content}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Sent_To" Header="Sent To" FixedWidth="120" DefaultWidth="120" DisplayMemberBinding="{Binding SentTo}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Sent_At" Header="Sent At" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding SentAt, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Received_From" Header="Received from" FixedWidth="120" DefaultWidth="120" DisplayMemberBinding="{Binding ReceivedFrom}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                                <sts:FixedWidthColumn sts:WPFGridViewHelper.ColumnName="Note_Received_At" Header="Received At" FixedWidth="128" DefaultWidth="128" DisplayMemberBinding="{Binding ReceivedAt, Converter={StaticResource DateToDisplayConverter}}" AllowResize="True" VisibilityChanged="NotesColumnVisibilityChanged" WidthChanged="NotesColumn_WidthChanged"/>
                            </GridView>
                        </ListView.View>
                        <ListView.ContextMenu>
                            <ContextMenu Name="ctmList" Opened="ListMenu_Opened">
                                <ContextMenu.CommandBindings>
                                    <CommandBinding Command="{x:Static net:MainCommands.NewNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.LoadNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.NoteFromClipboardCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.DuplicateNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SaveAsShortcutCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.DiaryCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.TodayCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SaveNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SaveAsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SaveAsTextCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.RestoreFromBackupCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.PrintCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Adjust}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.AdjustAppearanceCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.AdjustScheduleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.DeleteNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SaveAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.BackupSyncCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.BackupCreateCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.BackupRestoreCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SyncLocalCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ImportNotesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ImportSettingsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ImportFontsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ImportDictionariesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpPdfCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpTiffCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpDocCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpRtfCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpTxtCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ExpAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.PrintFieldsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Placement}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.DockAllCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.DockNoneCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.DockLeftCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.DockTopCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.DockRightCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.DockBottomCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Visibility}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.ShowAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.HideNoteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.HideAllCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.AllToFrontCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Centralize}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SendAsTextCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SendAsAttachmentCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SendAsZipCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SendNetworkCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ContactAddCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ContactGroupAddCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ContactSelectCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ContactGroupSelectCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.TagsCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.TagsCurrent}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.TagsShowByCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.TagsHideByCommand}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Switches}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.OnTopCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.HighPriorityCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ProtectionModeCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.SetNotePasswordCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.RemoveNotePasswordCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.MarkAsCompleteCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.RollUnrollCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.PinCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.UnpinCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.ScrambleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.UnscrambleCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.AddFavoritesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:NoteCommands.RemoveFavoritesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.RunCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.EmptyBin}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.RestoreNote}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Preview}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewSettings}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.UseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ChooseCustColor}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewRight}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.PreviewRightFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowGroupsOnCp}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ShowGroupsOnCpFromMenu}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ColReset}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.HotkeysCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.MenusManagementCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.PreferencesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Password}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.Search}" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.QuickSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.HelpCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SupportCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.AboutCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.PwrdCreateCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.PwrdChangeCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:CommonCommands.PwrdRemoveCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SearchInNotesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SearchByTagsCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:MainCommands.SearchByDatesCommand}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.IncBinInQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.ClearQSearch}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                    <CommandBinding Command="{x:Static net:ControlPanelCommands.QSearchIgnoreCase}" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
                                </ContextMenu.CommandBindings>
                                <MenuItem x:Name="mnuNewNote" Command="net:MainCommands.NewNoteCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource new_note}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuLoadNotes" Command="net:MainCommands.LoadNoteCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource load}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuNoteFromCB" Command="net:MainCommands.NoteFromClipboardCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource fromcp}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuDuplicateNote" Command="net:NoteCommands.DuplicateNoteCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource note_copy}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSaveAsShortcut" Command="net:NoteCommands.SaveAsShortcutCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource shortcut}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuDiary" Command="net:MainCommands.DiaryCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource diary}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuTodayDiary"/>
                                </MenuItem>
                                <Separator x:Name="toolStripMenuItem17"/>
                                <MenuItem x:Name="mnuSave" Command="net:NoteCommands.SaveNoteCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource save}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSaveAs" Command="net:NoteCommands.SaveAsCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource saveas}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSaveAsText" Command="net:NoteCommands.SaveAsTextCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource saveastext}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuRestoreFromBackup" Command="net:NoteCommands.RestoreFromBackupCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource restore}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuPrint" Command="net:NoteCommands.PrintCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource print}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuAdjust" Command="net:ControlPanelCommands.Adjust">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource control}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuAdjustAppearance"/>
                                    <StaticResourceExtension ResourceKey="mnuAdjustSchedule"/>
                                </MenuItem>
                                <Separator x:Name="toolStripMenuItem18"/>
                                <MenuItem x:Name="mnuDelete" Command="net:NoteCommands.DeleteNoteCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource deletenote}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator4"/>
                                <MenuItem x:Name="mnuSaveAll" Command="net:MainCommands.SaveAllCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource saveall}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator22"/>
                                <MenuItem x:Name="mnuBackup" Command="net:MainCommands.BackupSyncCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource back}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuBackupCreate"/>
                                    <StaticResourceExtension ResourceKey="mnuBackupRestore"/>
                                    <StaticResourceExtension ResourceKey="mnuSyncLocal"/>
                                    <Separator x:Name="toolStripMenuItem21"/>
                                    <StaticResourceExtension ResourceKey="mnuImportNotes"/>
                                    <StaticResourceExtension ResourceKey="mnuImportSettings"/>
                                    <StaticResourceExtension ResourceKey="mnuImportFonts"/>
                                    <StaticResourceExtension ResourceKey="mnuImportDictionaries"/>
                                    <Separator x:Name="sepExport"/>
                                    <StaticResourceExtension ResourceKey="mnuExportAll"/>
                                </MenuItem>
                                <Separator x:Name="toolStripMenuItem19"/>
                                <MenuItem x:Name="mnuPlacement" Command="net:ControlPanelCommands.Placement">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource placevis}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuDockAll"/>
                                    <StaticResourceExtension ResourceKey="mnuVisibility"/>
                                    <Separator x:Name="toolStripMenuItem2"/>
                                    <StaticResourceExtension ResourceKey="mnuCentralize"/>
                                </MenuItem>
                                <Separator x:Name="toolStripMenuItem20"/>
                                <MenuItem x:Name="mnuSendAsText" Command="net:NoteCommands.SendAsTextCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource sendmail}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSendAsAttachment" Command="net:NoteCommands.SendAsAttachmentCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource sendattach}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSendZip" Command="net:NoteCommands.SendAsZipCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource mailzip}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuSendNetwork" Command="net:NoteCommands.SendNetworkCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource sendnetwork}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuAddContact"/>
                                    <StaticResourceExtension ResourceKey="mnuAddGroup"/>
                                    <Separator x:Name="toolStripMenuItem50"/>
                                    <StaticResourceExtension ResourceKey="mnuSelectContact"/>
                                    <StaticResourceExtension ResourceKey="mnuSelectGroup"/>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator23"/>
                                <MenuItem x:Name="mnuTags" Command="net:NoteCommands.TagsCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource tags}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuTagsCurrent"/>
                                    <StaticResourceExtension ResourceKey="mnuShowByTag"/>
                                    <StaticResourceExtension ResourceKey="mnuHideByTag"/>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator24"/>
                                <MenuItem x:Name="mnuSwitches" Command="net:ControlPanelCommands.Switches">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource check}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuOnTop"/>
                                    <StaticResourceExtension ResourceKey="mnuToggleHighPriority"/>
                                    <StaticResourceExtension ResourceKey="mnuToggleProtectionMode"/>
                                    <StaticResourceExtension ResourceKey="mnuSetPassword"/>
                                    <StaticResourceExtension ResourceKey="mnuRemovePassword"/>
                                    <StaticResourceExtension ResourceKey="mnuMarkAsComplete"/>
                                    <StaticResourceExtension ResourceKey="mnuRollUnroll"/>
                                    <StaticResourceExtension ResourceKey="mnuPin"/>
                                    <StaticResourceExtension ResourceKey="mnuUnpin"/>
                                    <StaticResourceExtension ResourceKey="mnuScramble"/>
                                    <StaticResourceExtension ResourceKey="mnuUnscramble"/>
                                </MenuItem>
                                <MenuItem x:Name="mnuFavorites" Command="net:NoteCommands.AddFavoritesCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource favadd}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuRemoveFromFavorites" Command="net:NoteCommands.RemoveFavoritesCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource favremove}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator26"/>
                                <MenuItem x:Name="mnuRun" Command="net:MainCommands.RunCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource run}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator27"/>
                                <MenuItem x:Name="mnuEmptyBin" Command="net:ControlPanelCommands.EmptyBin">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource bin_empty}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuRestoreNote" Command="net:ControlPanelCommands.RestoreNote">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource bin_restore}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator28"/>
                                <MenuItem x:Name="mnuPreview" IsChecked="True" IsCheckable="True" Command="net:ControlPanelCommands.PreviewFromMenu">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource preview}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuPreviewSettings" Command="net:ControlPanelCommands.PreviewSettings">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource preview_sett}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuUseCustColor"/>
                                    <StaticResourceExtension ResourceKey="mnuChooseCustColor"/>
                                </MenuItem>
                                <MenuItem x:Name="mnuPreviewRight" IsCheckable="True" Command="net:ControlPanelCommands.PreviewRightFromMenu">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource previewright}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator29"/>
                                <MenuItem x:Name="mnuShowGroups" IsChecked="True" IsCheckable="True" Command="net:ControlPanelCommands.ShowGroupsOnCpFromMenu">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource gr_view}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator37"/>
                                <MenuItem x:Name="mnuColReset" Command="net:ControlPanelCommands.ColReset">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource coleven}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuHotkeysCP" Command="net:MainCommands.HotkeysCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource hotkeys}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuMenusManagementCP" Command="net:MainCommands.MenusManagementCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource menus}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuPreferences" Command="net:MainCommands.PreferencesCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource prefs}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuPassword" Command="net:ControlPanelCommands.Password">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource password}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuPwrdCreate"/>
                                    <StaticResourceExtension ResourceKey="mnuPwrdChange"/>
                                    <StaticResourceExtension ResourceKey="mnuPwrdRemove"/>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator31"/>
                                <MenuItem x:Name="mnuSearch" Command="net:ControlPanelCommands.Search">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource search}"/>
                                    </MenuItem.Icon>
                                    <StaticResourceExtension ResourceKey="mnuSearchInNotes"/>
                                    <Separator x:Name="toolStripMenuItem11"/>
                                    <StaticResourceExtension ResourceKey="mnuSearchByTags"/>
                                    <Separator x:Name="toolStripMenuItem12"/>
                                    <StaticResourceExtension ResourceKey="mnuSearchByDates"/>
                                    <Separator x:Name="toolStripMenuItem13"/>
                                    <StaticResourceExtension ResourceKey="mnuIncBinInQSearch"/>
                                    <StaticResourceExtension ResourceKey="mnuClearQSearch"/>
                                    <StaticResourceExtension ResourceKey="mnuQSearchIgnoreCase"/>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator32"/>
                                <MenuItem x:Name="mnuHelp" Command="net:MainCommands.HelpCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource help}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator x:Name="toolStripSeparator33"/>
                                <MenuItem x:Name="mnuSupport" Command="net:MainCommands.SupportCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource support}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem x:Name="mnuAbout" Command="net:MainCommands.AboutCommand">
                                    <MenuItem.Icon>
                                        <Image Stretch="None" Source="{DynamicResource about}"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </ListView.ContextMenu>
                    </ListView>
                    <GridSplitter x:Name="SplitHorz"  Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" VerticalAlignment="Center" HorizontalAlignment="Stretch" Height="8" Background="{DynamicResource SplitterBackgrounsBrush}"/>
                    <GridSplitter x:Name="SplitVert"  Grid.Row="0" Grid.Column="1" Grid.RowSpan="3" VerticalAlignment="Stretch" HorizontalAlignment="Center" Width="8" Visibility="Collapsed" Background="{DynamicResource SplitterBackgrounsBrush}"/>
                    <Border x:Name="BorderHost"  Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" BorderBrush="{DynamicResource CommonControlBorderBrush}" BorderThickness="1">
                        <Border Name="brdHost" Margin="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                    </Border>
                </Grid>
            </Grid>
        </DockPanel>
        <Border Grid.Row="0" 
                Background="White" 
                Opacity="0.1"
                Visibility="{Binding Path=InLongOperation, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Converter={StaticResource BoolToVisibilityConverter}}"/>
        <StatusBar Name="stsCP" Grid.Row="1">
            <StatusBarItem Margin="4,0,4,0" VerticalAlignment="Center" VerticalContentAlignment="Center">
                <TextBlock x:Name="stlName"/>
            </StatusBarItem>
            <StatusBarItem Margin="4,0,4,0" VerticalAlignment="Center" VerticalContentAlignment="Center">
                <TextBlock x:Name="stlCount"/>
            </StatusBarItem>
            <StatusBarItem Margin="4,0,4,0" VerticalAlignment="Center" VerticalContentAlignment="Center">
                <TextBlock x:Name="stlTotal"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>

</Window>
